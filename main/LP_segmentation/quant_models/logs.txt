2019-03-19 12:09:51.117128: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-03-19 12:09:51.198405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:65:00.0
totalMemory: 11.91GiB freeMemory: 2.66GiB
2019-03-19 12:09:51.198430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-19 12:09:51.734682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-19 12:09:51.734714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-19 12:09:51.734719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-19 12:09:51.734936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2364 MB memory) -> physical GPU (device: 0, name: TITAN Xp, pci bus id: 0000:65:00.0, compute capability: 6.1)
Using validation set found in data/converted_dataset/test/xml/
Training shape:   1749
Validation shape: 300
Seen labels:	 {'plate': 1856}
Given labels:	 ['plate']
Overlap labels:	 {'plate'}
(14, 14)
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            (None, 448, 448, 3)  0                                            
__________________________________________________________________________________________________
mobilenet_1.00_224 (Model)      multiple             3228864     input_3[0][0]                    
__________________________________________________________________________________________________
DetectionLayer (Conv2D)         (None, 14, 14, 30)   30750       mobilenet_1.00_224[1][0]         
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 14, 14, 5, 6) 0           DetectionLayer[0][0]             
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 1, 1, 1, 1, 4 0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 5, 6) 0           reshape_1[0][0]                  
                                                                 input_2[0][0]                    
==================================================================================================
Total params: 3,259,614
Trainable params: 3,237,726
Non-trainable params: 21,888
__________________________________________________________________________________________________
it 0
Loading pre-trained weights from pruned_models/mobilenet_25it_1p_1/lp_seg_mobilenet_pruned_post-train_it25.h5
Generating mask from pre-trained weights...
Checking that the pruned weights were not modified...
>>>	0 of the 2821100 weights that have been pruned are NONzero (should be 0)
>>>	2821100 of the 3206976 total weights have been pruned (87.967606% of original)
2019-03-19 12:09:57.532117: E tensorflow/stream_executor/cuda/cuda_dnn.cc:373] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR
2019-03-19 12:09:57.535999: E tensorflow/stream_executor/cuda/cuda_dnn.cc:373] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR
Using TensorFlow backend.
Evaluating masked network, before train step:
Traceback (most recent call last):
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 1334, in _do_call
    return fn(*args)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 1319, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 1407, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.
	 [[{{node mobilenet_1.00_224/conv1/convolution}} = Conv2D[T=DT_FLOAT, _class=["loc:@mobilenet_1.00_224/conv1_bn/cond/batchnorm/mul_1/Switch"], data_format="NCHW", dilations=[1, 1, 1, 1], padding="SAME", strides=[1, 1, 2, 2], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](mobilenet_1.00_224/conv1/convolution-0-TransposeNHWCToNCHW-LayoutOptimizer, conv1/kernel/read)]]
	 [[{{node lambda_1/Identity/_1817}} = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2024_lambda_1/Identity", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "train_quantize.py", line 252, in <module>
    _main_(args)
  File "train_quantize.py", line 158, in _main_
    debug=config['train']['debug'])
  File "/media/qiujing/e5439522-63c4-4b7c-a968-fefee6a3d960/omead/aiOnChip/AIonChip_HOZ/main/LP_segmentation/frontend.py", line 522, in validate
    average_precisions = self.evaluate(valid_generator)
  File "/media/qiujing/e5439522-63c4-4b7c-a968-fefee6a3d960/omead/aiOnChip/AIonChip_HOZ/main/LP_segmentation/frontend.py", line 558, in evaluate
    pred_boxes = self.predict(raw_image)
  File "/media/qiujing/e5439522-63c4-4b7c-a968-fefee6a3d960/omead/aiOnChip/AIonChip_HOZ/main/LP_segmentation/frontend.py", line 652, in predict
    netout = self.model.predict([input_image, dummy_array])[0]
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/keras/engine/training.py", line 1790, in predict
    verbose=verbose, steps=steps)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/keras/engine/training.py", line 1299, in _predict_loop
    batch_outs = f(ins_batch)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/keras/backend/tensorflow_backend.py", line 2357, in __call__
    **self.session_kwargs)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 929, in run
    run_metadata_ptr)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 1152, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 1328, in _do_run
    run_metadata)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 1348, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.
	 [[node mobilenet_1.00_224/conv1/convolution (defined at /home/omead/keras-tf-venv3/lib/python3.5/site-packages/keras/backend/tensorflow_backend.py:3195)  = Conv2D[T=DT_FLOAT, _class=["loc:@mobilenet_1.00_224/conv1_bn/cond/batchnorm/mul_1/Switch"], data_format="NCHW", dilations=[1, 1, 1, 1], padding="SAME", strides=[1, 1, 2, 2], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](mobilenet_1.00_224/conv1/convolution-0-TransposeNHWCToNCHW-LayoutOptimizer, conv1/kernel/read)]]
	 [[{{node lambda_1/Identity/_1817}} = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2024_lambda_1/Identity", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]

Caused by op 'mobilenet_1.00_224/conv1/convolution', defined at:
  File "train_quantize.py", line 252, in <module>
    _main_(args)
  File "train_quantize.py", line 113, in _main_
    grad_mask_consts=grad_mask_consts)
  File "/media/qiujing/e5439522-63c4-4b7c-a968-fefee6a3d960/omead/aiOnChip/AIonChip_HOZ/main/LP_segmentation/frontend.py", line 54, in __init__
    self.feature_extractor = MobileNetFeature(self.input_size)
  File "/media/qiujing/e5439522-63c4-4b7c-a968-fefee6a3d960/omead/aiOnChip/AIonChip_HOZ/main/LP_segmentation/backend.py", line 217, in __init__
    x = mobilenet(input_image)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/keras/engine/topology.py", line 603, in __call__
    output = self.call(inputs, **kwargs)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/keras/engine/topology.py", line 2061, in call
    output_tensors, _, _ = self.run_internal_graph(inputs, masks)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/keras/engine/topology.py", line 2212, in run_internal_graph
    output_tensors = _to_list(layer.call(computed_tensor, **kwargs))
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/keras/layers/convolutional.py", line 164, in call
    dilation_rate=self.dilation_rate)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/keras/backend/tensorflow_backend.py", line 3195, in conv2d
    data_format=tf_data_format)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/ops/nn_ops.py", line 780, in convolution
    return op(input, filter)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/ops/nn_ops.py", line 868, in __call__
    return self.conv_op(inp, filter)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/ops/nn_ops.py", line 520, in __call__
    return self.call(inp, filter)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/ops/nn_ops.py", line 204, in __call__
    name=self.name)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 957, in conv2d
    data_format=data_format, dilations=dilations, name=name)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/util/deprecation.py", line 488, in new_func
    return func(*args, **kwargs)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py", line 3274, in create_op
    op_def=op_def)
  File "/home/omead/keras-tf-venv3/lib/python3.5/site-packages/tensorflow/python/framework/ops.py", line 1770, in __init__
    self._traceback = tf_stack.extract_stack()

UnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.
	 [[node mobilenet_1.00_224/conv1/convolution (defined at /home/omead/keras-tf-venv3/lib/python3.5/site-packages/keras/backend/tensorflow_backend.py:3195)  = Conv2D[T=DT_FLOAT, _class=["loc:@mobilenet_1.00_224/conv1_bn/cond/batchnorm/mul_1/Switch"], data_format="NCHW", dilations=[1, 1, 1, 1], padding="SAME", strides=[1, 1, 2, 2], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](mobilenet_1.00_224/conv1/convolution-0-TransposeNHWCToNCHW-LayoutOptimizer, conv1/kernel/read)]]
	 [[{{node lambda_1/Identity/_1817}} = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2024_lambda_1/Identity", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]

